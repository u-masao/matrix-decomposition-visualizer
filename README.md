# 特異値分解 (SVD) 可視化ツール ➗

[![License: MIT](https://img.shields.io/badge/License-MIT-yellow.svg)](https://opensource.org/licenses/MIT)

このツールは、行列分解手法の一つである**特異値分解 (Singular Value Decomposition, SVD)** を用いて、画像を分解し、再構成するプロセスをインタラクティブに可視化するための Gradio アプリケーションです。

画像のURLを入力すると、その画像をグレイスケールに変換し、ピクセル値を要素とする行列とみなしてSVD ($A = U \Sigma V^T$) を実行します。分解された行列 $U$, $\Sigma$, $V^T$ や、選択した特異値の数（ランク）に基づいて再構成された画像を視覚的に確認できます。

画像圧縮や次元削減におけるSVDの役割を直感的に理解することを目的としています。


## 機能

* **画像読み込み:** 指定されたURLから画像をダウンロードし、グレイスケールに変換します。
* **SVD実行:** グレイスケール画像をNumPy配列に変換し、`numpy.linalg.svd` を用いて特異値分解を実行します。
* **行列の可視化:** 分解された行列 $U$ (左特異ベクトル)、$\Sigma$ (特異値)、$V^T$ (右特異ベクトル) をヒートマップと分布図で表示します。特異値 $\Sigma$ は対数スケールで表示されます。
* **インタラクティブな画像再構成:**
    * スライダーで再構成に使用する特異値の数（ランク $k$）を指定できます。
    * **大きい特異値:** 上位 $k$ 個の特異値を使って再構成した画像を表示します。
    * **指定の特異値:** $k$ 番目の特異値のみを使って再構成した画像を表示します。
    * **小さい特異値:** $k$ 番目より後の特異値を使って再構成した画像を表示します。
    * それぞれの再構成画像のヒートマップも表示します。
* **オリジナル画像との比較:** 元のグレイスケール画像と、全ての特異値を使って再構成した画像を表示します。
* **詳細情報の表示:** 分解された行列の形状 ($U$, $\Sigma$, $V^T$)、特異値の統計情報 (Pandas `describe`)、指定したインデックスに対応する特異値や特異ベクトルの一部を表示します。
* **サンプルURL:** いくつかのサンプル画像URLが用意されており、クリックするだけで試すことができます。

## セットアップと実行

1.  **リポジトリのクローン (任意):**
    ```bash
    git clone https://github.com/u-masao/matrix-decomposition-visualizer.git
    cd matrix-decomposition-visualizer
    ```

2.  **必要なライブラリのインストール:**
    ```bash
    uv sync
    ```

3.  **Python スクリプトの実行:**
    ```bash
    make run
    ```

4.  **ブラウザでアクセス:**
    実行後、ターミナルに表示されるローカルURL (通常 `http://127.0.0.1:7860`) にWebブラウザでアクセスします。

## 使い方

1.  **画像URLの入力:**
    * `1. 画像の URL` 入力欄に、表示したい画像のURLを入力します。
    * または、`サンプル画像のURL` から一つをクリックします。
    * `submit` ボタンを押すか、URL入力後にEnterキーを押します。
2.  **初期表示の確認:**
    * 画像が読み込まれ、グレイスケール画像（オリジナル）と、全ての特異値で再構成された画像が表示されます。
    * 同時に、分解された行列 $U, \Sigma, V^T$ のヒートマップが表示されます。
3.  **特異値インデックスの操作:**
    * `2. 再構成に利用する特異値のインデックス` スライダーをドラッグします。
    * スライダーの値に応じて、**大きい特異値**、**指定の特異値**、**小さい特異値** それぞれを使って再構成された画像とヒートマップがリアルタイムで更新されます。
    * 下部の `memo` 欄に、選択したインデックスに関する詳細情報が表示されます。
4.  **結果の分析:**
    * スライダーを動かしながら、再構成画像の画質がどのように変化するか観察します。
    * 少ない（大きい）特異値で画像の主要な特徴が再構成されること、個々の特異値が画像に与える影響、大きい特異値と小さい特異値が持つ情報の違いなどを確認できます。
    * $U, \Sigma, V^T$ のヒートマップから、各行列の構造や特異値の分布を視覚的に捉えます。

## 技術スタック

* **Web フレームワーク:** [Gradio](https://www.gradio.app/)
* **数値計算・SVD:** [NumPy](https://numpy.org/)
* **データ操作:** [Pandas](https://pandas.pydata.org/)
* **画像処理:** [Pillow (PIL Fork)](https://python-pillow.org/)
* **HTTPリクエスト:** [Requests](https://requests.readthedocs.io/en/latest/)
* **プロット・可視化:** [Matplotlib](https://matplotlib.org/), [Seaborn](https://seaborn.pydata.org/)

## ライセンス

このプロジェクトは [MIT License](LICENSE) の下で公開されています。
